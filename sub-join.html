<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>SRT ‚Üí –ß–∏—Å—Ç—ã–π —Ç–µ–∫—Å—Ç (–æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)</title>
  <style>
    *{box-sizing:border-box}
    
    :root {
      --bg-color: #fff;
      --text-color: #000;
      --section-bg: #fff;
      --input-bg: #fff;
      --input-border: #ccc;
      --button-bg: #f0f0f0;
      --button-hover: #e0e0e0;
      --button-text: #000;
    }
    
    [data-theme="dark"] {
      --bg-color: #1a1a1a;
      --text-color: #e0e0e0;
      --section-bg: #1a1a1a;
      --input-bg: #2a2a2a;
      --input-border: #444;
      --button-bg: #3a3a3a;
      --button-hover: #4a4a4a;
      --button-text: #e0e0e0;
    }
    
    body{
      font-family:Arial, sans-serif;
      margin:0;
      padding:20px;
      display:flex;
      gap:24px;
      background: var(--bg-color);
      color: var(--text-color);
      transition: background 0.3s ease, color 0.3s ease;
      position: relative;
      justify-content: center;
    }
    
    section{
      flex:1;
      max-width: 800px;
      display:flex;
      flex-direction:column;
      background: var(--section-bg);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    h2{margin:0 0 12px;font-size:20px}
    label{margin-top:12px;font-weight:600}
    
    textarea{
      width:100%;
      height:300px;
      resize:vertical;
      margin-top:4px;
      padding:8px;
      background: var(--input-bg);
      color: var(--text-color);
      border: 1px solid var(--input-border);
      border-radius: 4px;
      transition: background 0.3s ease, border-color 0.3s ease;
    }
    
    button{
      margin-top:12px;
      padding:8px 14px;
      font-size:14px;
      cursor:pointer;
      background: var(--button-bg);
      color: var(--button-text);
      border: 1px solid var(--input-border);
      border-radius: 4px;
      transition: background 0.3s ease;
    }
    
    button:hover{
      background: var(--button-hover);
    }
    
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--button-bg);
      border: 1px solid var(--input-border);
      border-radius: 50px;
      padding: 8px 16px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 16px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      z-index: 1000;
    }
    
    .theme-toggle:hover {
      background: var(--button-hover);
      transform: scale(1.05);
    }
    
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }
      
      .theme-toggle {
        top: 10px;
        right: 10px;
        padding: 6px 12px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>

<button class="theme-toggle" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
  <span id="themeIcon">üåô</span>
  <span id="themeText">–¢—ë–º–Ω–∞—è</span>
</button>

<section>
  <h2>–í—Å—Ç–∞–≤—å—Ç–µ SRT</h2>
  <label for="inputSrt">–°—É–±—Ç–∏—Ç—Ä—ã (SRT)</label>
  <textarea id="inputSrt" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–µ —Å—É–±—Ç–∏—Ç—Ä—ã"></textarea>

  <button id="convertBtn">–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å ‚Üí</button>

  <label for="outputPlain">–†–µ–∑—É–ª—å—Ç–∞—Ç (—á–∏—Å—Ç—ã–π —Ç–µ–∫—Å—Ç)</label>
  <textarea id="outputPlain" readonly></textarea>
</section>

<script>
function srtToPlain(raw){
  // 1. —É–±—Ä–∞—Ç—å –Ω–æ–º–µ—Ä–∞ –±–ª–æ–∫–æ–≤
  let txt = raw.replace(/^\d+\s*[\r\n]+/gm,'');
  // 2. —É–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Ç–∞–π–º–∫–æ–¥–æ–≤
  txt = txt.replace(/^\d{2}:\d{2}:\d{2},\d{3}\s*-->\s*\d{2}:\d{2}:\d{2},\d{3}.*(\r?\n)?/gm,'');
  // 3. —É–¥–∞–ª–∏—Ç—å HTML-—Ç–µ–≥–∏
  txt = txt.replace(/<[^>]+>/g,'');
  // 4. –ø–µ—Ä–µ–≤–æ–¥—ã —Å—Ç—Ä–æ–∫ ‚Üí –ø—Ä–æ–±–µ–ª
  txt = txt.replace(/\r?\n+/g,' ');
  // 5. –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –≤ –æ–¥–∏–Ω
  return txt.replace(/\s+/g,' ').trim();
}

document.getElementById('convertBtn').addEventListener('click',()=>{
  const raw = document.getElementById('inputSrt').value;
  const plain = srtToPlain(raw);
  const out = document.getElementById('outputPlain');
  out.value = plain;
  out.focus();
  out.select();
});
</script>

<script>
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π —Ç–µ–º—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  const savedTheme = localStorage.getItem('theme') || 'light';
  document.documentElement.setAttribute('data-theme', savedTheme);
  
  const themeToggle = document.getElementById('themeToggle');
  const themeIcon = document.getElementById('themeIcon');
  const themeText = document.getElementById('themeText');
  
  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –∏ —Ç–µ–∫—Å—Ç–∞
  function updateThemeUI(theme) {
    if (theme === 'dark') {
      themeIcon.textContent = '‚òÄÔ∏è';
      themeText.textContent = '–°–≤–µ—Ç–ª–∞—è';
    } else {
      themeIcon.textContent = 'üåô';
      themeText.textContent = '–¢—ë–º–Ω–∞—è';
    }
  }
  
  // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  updateThemeUI(savedTheme);
  
  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
  themeToggle.addEventListener('click', () => {
    const currentTheme = document.documentElement.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    
    document.documentElement.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
    updateThemeUI(newTheme);
  });
</script>

</body>
</html>
